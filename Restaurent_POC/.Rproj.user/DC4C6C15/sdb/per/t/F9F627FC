{
    "collab_server" : "",
    "contents" : "library(shiny)\nlibrary(shinydashboard)\nlibrary(googleVis)\nlibrary(plotly)\nserver <- function(input, output) {\n  \n  output$grosss_sales<- renderValueBox({\n    inFile <- input$file1\n    if (is.null(inFile))\n      return(NULL)\n    data2 <- as.data.frame(read.csv(inFile$datapath))\n      valueBox(\n      paste(round(sum(data2$Gross_Sale ))), \"Revenue\", icon = icon(\"glyphicon glyphicon-usd\",lib=\"glyphicon\"),\n      color = \"orange\")\n    \n  })\n  \n  output$cash <- renderValueBox({\n    inFile <- input$file1\n     if (is.null(inFile))\n       return(NULL)\n    data2 <- as.data.frame(read.csv(inFile$datapath))\n   valueBox(\n      paste(sum(data2$Cash )), \"Cash\", icon = icon(\"glyphicon glyphicon-usd\",lib=\"glyphicon\"),\n      color = \"blue\"\n    )\n  })\n  \n  output$credit_card <- renderValueBox({\n    inFile <- input$file1\n    if (is.null(inFile))\n      return(NULL)\n    data2 <- as.data.frame(read.csv(inFile$datapath))\n    valueBox(\n      paste(round(sum(data2$Credit_Card ))), \"Credit Card\", icon = icon(\"glyphicon glyphicon-credit-card\",lib=\"glyphicon\"),\n      color = \"purple\"\n    )\n  })\n  \n  output$tax <- renderValueBox({\n    inFile <- input$file1\n    if (is.null(inFile))\n      return(NULL)\n    data2 <- as.data.frame(read.csv(inFile$datapath))\n    tax1<-(sum(data2$Sale_Including_Tax)-sum(data2$Net_Sale_Excluding_Tax))\n    valueBox(\n      paste(round(tax1,0)), \"Tax\", icon = icon(\"glyphicon glyphicon-arrow-down\",lib=\"glyphicon\"),\n      color = \"olive\")\n  })\n  \n  output$Day_sales_jan<- renderGvis({\n    inFile <- input$file1\n    if (is.null(inFile))\n      return(NULL)\n    data2 <- as.data.frame(read.csv(inFile$datapath))\n    Gross_sales<-data2$Gross_Sale\n    Date<-data2$Date\n        Total_sales<-data.frame(Date,Gross_sales)\n        totalsales<-gvisColumnChart(Total_sales,options=list(colors=\"['0099CC','CCFFCC','#BA4A00']\"))\n    return(totalsales)\n    \n  })\n  \n output$last5days_sales<- renderGvis({\n    inFile <- input$file1\n    if (is.null(inFile))\n      return(NULL)\n    daydata <- as.data.frame(read.csv(inFile$datapath))\n    Day<-daydata$Day\n    sales<-daydata$Sale\n    \n    y<-length(daydata$Day)\n    \n    Sun <- 0\n    for(i in 1:y)\n    {\n      if(Day[i]=='SUN')\n      {\n        \n        Sun<-Sun+daydata$Gross_Sale[i]\n        \n      }\n      \n    }\n    # Sunday<-Sun\n    Mon <- 0\n    for(i in 1:y)\n    {\n      if(Day[i]=='MON')\n      {\n        \n        Mon<-Mon+daydata$Gross_Sale[i]\n        \n      }\n      \n    }\n    #Monday<-Mon\n    Tue <- 0\n    for(i in 1:y)\n    {\n      if(Day[i]=='TUE')\n      {\n        \n        Tue<-Tue+daydata$Gross_Sale[i]\n        \n      }\n      \n    }\n    #Tuesday<-Tue\n    Wed <- 0\n    for(i in 1:y)\n    {\n      if(Day[i]=='WED')\n      {\n        \n        Wed<-Wed+daydata$Gross_Sale[i]\n        \n      }\n      \n    }\n    #Wednesday<-Wed\n    \n    Thu <- 0\n    for(i in 1:y)\n    {\n      if(Day[i]=='THU')\n      {\n        \n        Thu<-Thu+daydata$Gross_Sale[i]\n        \n      }\n      \n    }\n    #Thursday<-Thu\n    \n    Fri <- 0\n    for(i in 1:y)\n    {\n      if(Day[i]=='FRI')\n      {\n        \n        Fri<-Fri+daydata$Gross_Sale[i]\n        \n      }\n      \n    }\n    #Friday<-Fri\n    Sat <- 0\n    for(i in 1:y)\n    {\n      if(Day[i]=='SAT')\n      {\n        \n        Sat<-Sat+daydata$Gross_Sale[i]\n        \n      }\n      \n    }\n    Week<-c(Sun,Mon,Tue,Wed,Thu,Fri,Sat)\n    Days<-c(\"Sun\",\"Mon\",\"Tue\",\"Wed\",\"Thu\",\"Fri\",\"Sat\")\n    WeekDays<-cbind.data.frame(Days,Week)\n    #View(WeekDays)\n    Weeksales<-gvisColumnChart(WeekDays)\n    return(Weeksales)\n    \n })\n  output$dine_walk<- renderGvis({\n    inFile <- input$file1\n    if (is.null(inFile))\n      return(NULL)\n    data2 <- as.data.frame(read.csv(inFile$datapath))\n    Date<-data2$Date\n    Dine_In<-data2$Dine_In\n    Walk_In<-data2$Walk_In\n    Total_walk_dine<-data.frame(Date,Dine_In,Walk_In)\n    walk_chart<-gvisLineChart(Total_walk_dine,options=list(colors=\"['0199CC','AAAAAC','#F#4A00']\"))\n    return(walk_chart)\n  })\n  \n  output$month_checks <- renderValueBox({\n    inFile <- input$file1\n    if (is.null(inFile))\n      return(NULL)\n    data2 <- as.data.frame(read.csv(inFile$datapath))\n    valueBox(\n      paste(round(sum(data2$Restaurant_Checks ))), \"Checks\", icon = icon(\"glyphicon glyphicon-user\",lib=\"glyphicon\"),\n      color = \"green\")\n  })\n  \n  output$weeked_SALES<- renderValueBox({\n    inFile <- input$file1\n    if (is.null(inFile))\n      return(NULL)\n    daydata <- as.data.frame(read.csv(inFile$datapath))\n    Day<-daydata$Day\n    sales<-daydata$Sale\n    \n    y<-length(daydata$Day)\n    \n    weeksum<-0\n    for(i in 1:y)\n    {\n      if(Day[i]=='SUN'||Day[i]=='SAT')\n      {\n        weeksum<-weeksum+daydata$Gross_Sale[i]\n      }\n    }\n    valueBox(\n      paste(round(weeksum,0)), \"Weekend Sales\", icon = icon(\"glyphicon glyphicon-usd\",lib=\"glyphicon\"),\n      color = \"orange\"\n    )\n  })\n  \n  output$Avg_Rev_per_day <- renderValueBox({\n    inFile <- input$file1\n    if (is.null(inFile))\n      return(NULL)\n    data2 <- as.data.frame(read.csv(inFile$datapath))\n    valueBox(\n      paste(round(sum(data2$Gross_Sale)/nrow(data2),0)), \"Average Revenue per Day\", icon = icon(\"glyphicon glyphicon-usd\",lib=\"glyphicon\"),\n      color = \"red\")\n  })\n  \n  output$monthly_home_delivaeries <- renderValueBox({\n    inFile <- input$file1\n    if (is.null(inFile))\n      return(NULL)\n    data2 <- as.data.frame(read.csv(inFile$datapath))\n    valueBox(\n      paste(round(sum(data2$Delivery))), \"Home Deliveries\", icon = icon(\"glyphicon glyphicon-usd\",lib=\"glyphicon\"),\n      color = \"purple\")\n  })\n  \n  \n##################################################################################################################################################\n  ################# Day Sales ###########################\n output$Top_Item<- renderValueBox({\n      inFile <- input$file2\n      if (is.null(inFile))\n        return(NULL)\n      daydata <- as.data.frame(read.csv(inFile$datapath))\n      \n      valueBox(\n        paste(round(max(daydata$TOTAL,0))), \"Top Item\", icon = icon(\"glyphicon glyphicon-usd\",lib=\"glyphicon\"),\n        color = \"red\")\n    })\n  output$revenue<- renderValueBox({\n    inFile <- input$file2\n    if (is.null(inFile))\n      return(NULL)\n    daydata <- as.data.frame(read.csv(inFile$datapath))\n    valueBox(\n      paste(round(sum(daydata$  AMOUNT,0))), \"Revenue\", icon = icon(\"glyphicon glyphicon-usd\",lib=\"glyphicon\"),\n      color = \"green\")\n  })\n  \n  output$tax_day<- renderValueBox({\n    inFile <- input$file2\n    if (is.null(inFile))\n      return(NULL)\n    daydata <- as.data.frame(read.csv(inFile$datapath))\n    valueBox(\n      paste(round(sum(daydata$  TAX_AMT,0))), \"Tax\", icon = icon(\"glyphicon glyphicon-usd\",lib=\"glyphicon\"),\n      color = \"navy\")\n  })\n  \n  output$top_orders<- renderValueBox({\n    inFile <- input$file2\n    if (is.null(inFile))\n      return(NULL)\n    daydata <- as.data.frame(read.csv(inFile$datapath))\n    # assign(\"data2\",\"new\",envir = .GlobalEnv)\n    valueBox(\n      paste(round(max(daydata$  QTY,0))), \"Top Order\", icon = icon(\"glyphicon glyphicon-usd\",lib=\"glyphicon\"),\n      color = \"orange\"\n    )\n  })\n  output$BILL_DISCOUNT<- renderValueBox({\n    inFile <- input$file2\n    if (is.null(inFile))\n      return(NULL)\n    daydata <- as.data.frame(read.csv(inFile$datapath))\n    # assign(\"data2\",\"new\",envir = .GlobalEnv)\n    valueBox(\n      paste(round(sum(daydata$BILL_DISCOUNT,0))), \"Discount Amount\", icon = icon(\"glyphicon glyphicon-usd\",lib=\"glyphicon\"),\n      color = \"fuchsia\"\n    )\n  })\n  \n  output$item_sales<- renderPlotly({\n    m <- list(\n      l = 50,\n      r = 50,\n      b = 100,\n      t = 100,\n      pad = 4\n    )\n      inFile <- input$file2\n      if (is.null(inFile))\n        return(NULL)\n      daydata <- as.data.frame(read.csv(inFile$datapath))\n      Category_Names<-as.list(daydata$Category_Names)\n      TOTAL<-as.list(daydata$TOTAL)\n      TAX_AMT<-as.list(daydata$TAX_AMT)\n      \n      p<-plot_ly(daydata, x = ~Category_Names) %>%\n        \n        add_bars(y=~TOTAL, name = \"item_sale\", visible = T) %>%\n        add_bars(y=~TAX_AMT, name = \"item_tax\", visible = T)%>%\n      layout(autosize = F, width = 1800, height = 375, margin = m)\n      return(p)\n      \n    })\n  \n  output$item_qty<- renderPlotly({\n    m <- list(\n      l = 50,\n      r = 50,\n      b = 100,\n      t = 100,\n      pad = 4\n    )\n      inFile <- input$file2\n      if (is.null(inFile))\n        return(NULL)\n      daydata <- as.data.frame(read.csv(inFile$datapath))\n      Category_Names<-as.list(daydata$Category_Names)\n     QTY<-as.list(daydata$QTY)\n      \n      p<-plot_ly(daydata, x = ~Category_Names) %>%\n        \n        add_lines(y=~QTY, name = \"item_QTY\", visible = T)%>%\n      layout(autosize = F, width = 1600, height = 375, margin = m)\n      return(p)\n      \n    })\n  \n  # output$sunday_sales <- renderPlotly({\n  #   inFile <- input$file2\n  #   if (is.null(inFile))\n  #     return(NULL)\n  #   daydata <- as.data.frame(read.csv(inFile$datapath))\n  #   \n  #   p<-plot_ly(daydata, x = ~ITEMNAME) %>%\n  #     \n  #     add_lines(y=~QTY, name = \"item_QTY\", visible = T)\n  #   return(p)\n  #   \n  # })\n  output$item__tax_sales<- renderPlotly({\n    m <- list(\n      l = 50,\n      r = 50,\n      b = 100,\n      t = 100,\n      pad = 4\n    )\n    inFile <- input$file2\n    if (is.null(inFile))\n      return(NULL)\n    daydata <- as.data.frame(read.csv(inFile$datapath))\n    # assign(\"data2\",\"new\",envir = .GlobalEnv)\n    \n    \n    Category_Names<-as.list(daydata$Category_Names)\n    TOTAL<-as.list(daydata$TOTAL)\n    TAX_AMT<-as.list(daydata$TAX_AMT)\n    data<-data.frame(Category_Names,TAX_AMT)\n    p <- plot_ly(data, x = ~Category_Names, y = ~TOTAL, type = 'bar', name = 'Item_Total', marker = list(color = '#0000FF')) %>%\n      add_trace(y = ~TAX_AMT, name = 'Item_Tax', marker = list(color = '#7FFF0')) %>%\n       layout(autosize = F, width = 1800, height = 375, margin = m)\n    return(p)\n  })\n  \n  \n }",
    "created" : 1491304108639.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "4253743583",
    "id" : "F9F627FC",
    "lastKnownWriteTime" : 1491314182,
    "last_content_update" : 1491314182665,
    "path" : "C:/Users/Rama Devi/Desktop/Restaurent_POC/server.R",
    "project_path" : "server.R",
    "properties" : {
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}